# ğŸ“¦ PIV QR Inventory Counting System (Google Apps Script + Sheets + Mobile Web App)

![Status](https://img.shields.io/badge/status-work_in_progress-yellow)
![Platform](https://img.shields.io/badge/platform-Google%20Apps%20Script-34A853)
![Database](https://img.shields.io/badge/database-Google%20Sheets-0F9D58)
![Frontend](https://img.shields.io/badge/frontend-HTML%20%2B%20JavaScript-blue)
![Mobile](https://img.shields.io/badge/mobile-friendly-success)
![License](https://img.shields.io/badge/license-MIT-lightgrey)

â­ **PIV Automation System**

A lightweight, multi-operator **Physical Inventory Verification (PIV)** system built entirely on **Google Sheets + Apps Script**, designed to digitize a manual, error-prone inventory counting process using **QR codes** and a **mobile-friendly web app** (no installation required).

Operators scan part QR codes, enter physical stock (boxes Ã— qty/box + loose qty), tag the area ( Area 1/2/3 ), and the system automatically generates a **Difference Report** showing shortages/excess â€” making audits faster, cleaner, and audit-ready.

---

## ğŸš€ Key Highlights

- âœ… **Mobile QR scan web app** (with manual fallback)
- âœ… Designed for **10+ operators scanning simultaneously** 
- âœ… Structured physical count entry:
  - Boxes count Ã— Qty per box
  - Loose quantity support
  - Auto physical total calculation
- âœ… Area-aware scanning:
  - Area 1 / Area 2 (sub-Area) / Area 3
- âœ… Central backend logging to Google Sheets with timestamped scan history
- âœ… Automated **System vs Physical reconciliation** via Difference Report generator
- âœ… Built for real-world usage (fast UI, minimal clicks, audit-friendly logs)

---

## âœ¨ Features

### âœ… QR-Based Scanning Flow
- QR format (example):
  `Part_ID | Description | Location | SystemStock`
- Mobile web app reads QR using phone camera (no app install required)
- Manual QR input available for fallback

---

### âœ… Mobile-Friendly UI (Shopfloor Ready)
- Large buttons & inputs for fast operator use
- One-tap QR scan start + auto-detect + auto-process
- Beep + vibration feedback on successful scan
- Minimal typing required

---

### âœ… Multi-Area / Multi-Location Awareness
Operators must select the scanning area:
- `Loc_area_1` â†’ Your area_1 location
- `Loc_area_2` â†’ Your area_2, with sub-location (optional)
- `Loc_area_3` â†’ Your area_3 tagging

---

### âœ… Central Logging in Google Sheets (`count`)
Every scan appends a row with:
- Timestamp
- Part ID, description
- Area type
- location / sub-location
- System stock
- Box count, qty per box, loose qty
- Physical quantity (calculated)
- Recorder name (optional)

---

### âœ… Automated Difference Report (`Difference_Report`)
The system generates a reconciliation sheet that shows:

- `system_stock`
- `physical_total` (sum of scans per Part_ID)
- `difference = physical_total - system_stock`

This makes it easy to instantly spot:
- shortages (negative difference)
- excess (positive difference)

---

## ğŸ§± Google Sheets Structure

Create a Google Spreadsheet with these sheets:

### 1) `Main` sheet (System Stock Reference)
Expected columns:
- **A:** Part_ID
- **B:** Description
- **D:** System_Stock

> Tip: This sheet is your inventory master reference, you can lock it.

---

### 2) `count` sheet (Scan Log)
Each scan is appended as a new row by Apps Script.

---

### 3) `Difference_Report` (Auto-generated)
Generated by script via menu:
**PIV Tools â†’ Rebuild Difference Report**

---

## ğŸ› ï¸ Tech Stack

- **Google Sheets** â†’ Data store + reporting
- **Google Apps Script** â†’ Backend + automation
- **HTML / JavaScript** â†’ Mobile web UI
- **HTML5 BarcodeDetector API** â†’ QR scanning in supported browsers

---

## ğŸ§  How It Works (Simple)

1. Operator scans QR code using mobile camera
2. App extracts Part info from QR string
3. Operator enters physical count + selects area
4. Apps Script logs scan to `count` sheet
5. Difference Report aggregates totals and shows variance vs system stock

---

## ğŸ§© Project Structure
```bash
PIV-QR-Inventory-Counting-System/
â”œâ”€â”€ Code.gs          # Apps Script backend (logging + difference report)
â”œâ”€â”€ index.html       # Mobile-friendly web UI (QR scan + count entry)
â””â”€â”€ README.md
```
---

## âš™ï¸ Setup & Deployment (Step-by-Step)

1. Create the Google Spreadsheet with these 3 sheets (case-sensitive):
-Main 
-count 
-Difference_Report 

```bash
2. Add Apps Script Code
â”œâ”€â”€Go to Extensions â†’ Apps Script
â”œâ”€â”€Create / paste:
â”œâ”€â”€Code.gs
â””â”€â”€index.html
```

3. Deploy as Web App (Use Chrome in incognito mode on mobile for best QR scanning support)

---

## ğŸ“² Usage (Operator Flow)
```bash
â”œâ”€â”€Open the Web App link on mobile
â”œâ”€â”€Tap ğŸ“· Start QR Scan
â”œâ”€â”€QR gets detected â†’ beep + vibration â†’ auto fills details
â”œâ”€â”€Select Area
â”œâ”€â”€Enter Details
â”œâ”€â”€Tap Save
â””â”€â”€Scan next part âœ…
```

## ğŸ“Š Generate Difference Report

From the spreadsheet menu select PIV Tools â†’ Rebuild Difference Report. Rows are appended in this order by Apps Script:
```bash
_________________________________
|**Col**|	    **Field**         |
---------------------------------
|  A	  | Timestamp             |
|  B	  | Part_ID               |
|  C	  | Description           |
|  D	  | Area_Type             |
|  E	  | Area_Location         |
|  F	  | Sub_Location          | 
|  G	  | System_Stock          |
|  H	  | Box_Count             |
|  I	  | Qty_Per_Box           |
|  J	  | Physical_Qty (packed) |
|  K	  | Loose_Qty             |
|  L	  | Reserved              |
|  M	  | Recorder_Name         | 
|_______________________________|
```

---

## âš ï¸ Known Limitations
```bash
-No hard blocking of duplicate scans (system logs everything â€” audit trail style)
-If sheet names change, the script will fail
-No user authentication inside UI (access control is controlled via Web App deployment settings)
```

---

## ğŸ—ºï¸ Future Improvements (Planned)
```bash
-Permanent QR migration (unique Part_ID-based QR master)
-Auto-sync â€œlast scan per partâ€ (Some times industries requires multiple scans per Item, Hence cannot implement hard blocking of duplicate scans)
```

---

## ğŸ“„ License

This project is licensed under the MIT License.

---

## ğŸ‘¤ Author

Built by Yash
ğŸ“Œ Shopfloor-ready automation project using Google Sheets + QR + Apps Scrip

---
